<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title></title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>Replication output for article, “hermiter: R package for Sequential
Nonparametric Estimation”. The output below corresponds to the output
produced by running knitr::spin() on the article_replication.R script,
with short_run set to FALSE.</p>
<p>Load libraries.</p>
<pre><code class="language-r">options(dplyr.summarise.inform = F)
library(hermiter)
library(tdigest)
library(microbenchmark)
library(dplyr)
</code></pre>
<pre><code>## 
## Attaching package: 'dplyr'
</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag
</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
</code></pre>
<pre><code class="language-r">library(randtoolbox)
</code></pre>
<pre><code>## Loading required package: rngWELL
</code></pre>
<pre><code>## This is randtoolbox. For an overview, type 'help(&quot;randtoolbox&quot;)'.
</code></pre>
<pre><code class="language-r">library(ggplot2)
library(patchwork)
library(arrow)
</code></pre>
<pre><code>## 
## Attaching package: 'arrow'
</code></pre>
<pre><code>## The following object is masked from 'package:utils':
## 
##     timestamp
</code></pre>
<p>Set random seed for reproducibility.</p>
<pre><code class="language-r">set.seed(10)
</code></pre>
<p>Choose whether to run quick version of reproduction script i.e. under
an hour of processing time on hardware specified in manuscript versus
full version which would take several hours of run-time.</p>
<pre><code class="language-r">short_run &lt;- FALSE
if (short_run == TRUE){
  total_number_of_runs &lt;- 10
} else {
  total_number_of_runs &lt;- 100
}
</code></pre>
<p>Reproduce univariate PDF, CDF and Q-Q plot figures i.e. <strong>Figures 1, 2, 3</strong>
in the text respectively.</p>
<pre><code class="language-r">observations &lt;- rlogis(n=5000)
hermite_est &lt;- hermite_estimator(observations = observations)
x &lt;- seq(-15,15,0.1)
pdf_est &lt;- dens(hermite_est,x)
cdf_est &lt;- cum_prob(hermite_est,x)
p &lt;- seq(0.05,0.95,0.05)
quantile_est &lt;- quant(hermite_est,p)
actual_pdf &lt;- dlogis(x)
actual_cdf &lt;- plogis(x)
df_pdf_cdf &lt;- data.frame(x,pdf_est,cdf_est,actual_pdf,actual_cdf)
actual_quantiles &lt;- qlogis(p)
df_quant &lt;- data.frame(p,quantile_est,actual_quantiles)

ggplot(df_pdf_cdf,aes(x=x)) + geom_line(aes(y=pdf_est, colour=&quot;Estimated&quot;)) +
  geom_line(aes(y=actual_pdf, colour=&quot;Actual&quot;)) +
  scale_colour_manual(&quot;&quot;,
                      breaks = c(&quot;Estimated&quot;, &quot;Actual&quot;),
                      values = c(&quot;blue&quot;, &quot;black&quot;)) + ylab(&quot;Probability Density&quot;)
</code></pre>
<p><img src="data:image/png;base64,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" alt="plot of chunk reproduce_univar" /></p>
<pre><code class="language-r">ggplot(df_pdf_cdf,aes(x=x)) + geom_line(aes(y=cdf_est, colour=&quot;Estimated&quot;)) +
  geom_line(aes(y=actual_cdf, colour=&quot;Actual&quot;)) +
  scale_colour_manual(&quot;&quot;,
                      breaks = c(&quot;Estimated&quot;, &quot;Actual&quot;),
                      values = c(&quot;blue&quot;, &quot;black&quot;)) +
  ylab(&quot;Cumulative Probability&quot;)
</code></pre>
<p><img src="data:image/png;base64,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" alt="plot of chunk reproduce_univar" /></p>
<pre><code class="language-r">ggplot(df_quant,aes(x=actual_quantiles)) + geom_point(aes(y=quantile_est),
                                                      color=&quot;blue&quot;) +
  geom_abline(slope=1,intercept = 0) +xlab(&quot;Theoretical Quantiles&quot;) +
  ylab(&quot;Estimated Quantiles&quot;)
</code></pre>
<p><img src="data:image/png;base64,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" alt="plot of chunk reproduce_univar" /></p>
<p>Reproduce bivariate PDF, CDF figures, namely <strong>Figure 4</strong> and <strong>Figure 5</strong> in
the text respectively.</p>
<pre><code class="language-r">sig_x &lt;- 1
sig_y &lt;- 1
num_obs &lt;- 5000
rho &lt;- 0.5
observations_mat &lt;- mvtnorm::rmvnorm(n=num_obs,mean=rep(0,2),
                                     sigma = matrix(c(sig_x^2,rho*sig_x*sig_y,
                                                    rho*sig_x*sig_y,sig_y^2),
                                                  nrow=2,ncol=2, byrow = TRUE))
hermite_est &lt;- hermite_estimator(est_type = &quot;bivariate&quot;,
                                 observations = observations_mat)
vals &lt;- seq(-5,5,by=0.25)
x_grid &lt;- as.matrix(expand.grid(X=vals, Y=vals))
pdf_est &lt;- dens(hermite_est,x_grid, clipped = TRUE)
cdf_est &lt;- cum_prob(hermite_est,x_grid,clipped = TRUE)
spear_est &lt;- spearmans(hermite_est)
kendall_est &lt;- kendall(hermite_est)
actual_pdf &lt;-mvtnorm::dmvnorm(x_grid,mean=rep(0,2),
                              sigma = matrix(c(sig_x^2,rho*sig_x*sig_y,
                                               rho*sig_x*sig_y,sig_y^2),
                                             nrow=2,ncol=2, byrow = TRUE))
actual_cdf &lt;- rep(NA,nrow(x_grid))
for (row_idx in seq_len(nrow(x_grid))) {
  actual_cdf[row_idx] &lt;-  mvtnorm::pmvnorm(lower = c(-Inf,-Inf),
                                           upper=as.numeric(x_grid[row_idx,]),
                                           mean=rep(0,2), sigma =
                                          matrix(c(sig_x^2, rho*sig_x*sig_y,
                                           rho*sig_x*sig_y,sig_y^2), nrow=2,
                                           ncol=2, byrow = TRUE))
}
actual_spearmans &lt;- cor(observations_mat,method = &quot;spearman&quot;)[1,2]
actual_kendall &lt;- cor(observations_mat,method = &quot;kendall&quot;)[1,2]
df_pdf_cdf &lt;- data.frame(x_grid,pdf_est,cdf_est,actual_pdf,actual_cdf)

p1 &lt;- ggplot(df_pdf_cdf) + geom_tile(aes(X, Y, fill= actual_pdf)) +
  scale_fill_gradient2(low=&quot;blue&quot;, mid=&quot;cyan&quot;, high=&quot;purple&quot;,
                       midpoint=.1,
                       breaks=seq(0,.2,by=.05),
                       limits=c(0,.2))

p2 &lt;- ggplot(df_pdf_cdf) + geom_tile(aes(X, Y, fill= pdf_est)) +
  scale_fill_gradient2(low=&quot;blue&quot;, mid=&quot;cyan&quot;, high=&quot;purple&quot;,
                       midpoint=.1,
                       breaks=seq(0,.2,by=.05),
                       limits=c(0,.2))

p1+ ggtitle(&quot;Actual PDF&quot;)+ theme(legend.title = element_blank()) + p2 +
  ggtitle(&quot;Estimated PDF&quot;) +theme(legend.title = element_blank()) +
  plot_layout(guides = 'collect')
</code></pre>
<p><img src="data:image/png;base64,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" alt="plot of chunk reproduce_bivar_fig" /></p>
<pre><code class="language-r">p1 &lt;- ggplot(df_pdf_cdf) + geom_tile(aes(X, Y, fill= actual_cdf)) +
  scale_fill_gradient2(low=&quot;blue&quot;, mid=&quot;cyan&quot;, high=&quot;purple&quot;,
                       midpoint=0.5,
                       breaks=seq(0,1,by=.2),
                       limits=c(0,1))

p2 &lt;- ggplot(df_pdf_cdf) + geom_tile(aes(X, Y, fill= cdf_est)) +
  scale_fill_gradient2(low=&quot;blue&quot;, mid=&quot;cyan&quot;, high=&quot;purple&quot;,
                       midpoint=0.5,
                       breaks=seq(0,1,by=.2), #breaks in the scale bar
                       limits=c(0,1))

p1+ ggtitle(&quot;Actual CDF&quot;) + theme(legend.title = element_blank()) + p2 +
  ggtitle(&quot;Estimated CDF&quot;) + theme(legend.title = element_blank())+
  plot_layout(guides = 'collect')
</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAIAAAApSmgoAAAACXBIWXMAAAsSAAALEgHS3X78AAAfMUlEQVR4nO3dTWwb6X3H8Wco+XW9u3mhty+K292AchpF6MmAGglGu4ceKBeEDq6O8U3stkBpo3BQ1AaKot6TUVgs0BrSzTksUNUHgahFoJc9LKRArU+B6yAWm2zqCGgSJdltvC/W2/RAUfMnxUd6hhxyRv/5fqDDaDicGZN//vxwqD8fz/d9AwDQKxP3CQAAeougBwDlCHoAUI6gBwDlCHoAUI6gBwDlCHoAUI6gBwDlCHoAUI6gBwDlCHoAUC6+oK8WPW+iXOvNzmvlCa9Ytd7UsL+JXOl5njyzAzfJ++F4a/fkuj69h9RY9KpF24uFeoaDuIK+Vr4zPzMzev3uUSUW7cupWvSGn97269Zmn0yKfc8s+fuWRq8PixeWvMn3fX8uH9UJIXatT+5hT6+sxlxpuZtCiKSwqWe4iSnoa48WVmambo6Mzy/2cTBRLU7OzyztV3Wu9GB2fP5Ou4FSfm5pZuXo/4WAGFHPcBVP0NdzPp8r3Z5pLkzxvrJYNcZUi8PXV8z8ZP2tpxwEyeVq0eldaHVx3sxMycFLrrTsL5dy7TbOT82YJ896dGUJx0JQV/XRsK0aa+UJr1hulG6xGpTxfjW2lmjzrpq2EBUcrFtsd3rUM1zFEvTVu9fN7M28MSY/NbOy8KhRftXi8PXRpf23ocWqyc+tzY6bmSVb+dbvNTm/9150aca0H9E0jI8Mu57k8Mj4ytO1+vL8JFc01Wp+coPnt1qcfDK71rjyca1cO7Qa5xfMg3oJzk9618wD3/fX9sfXB0u0ZVe18sSkWWoU/l74B/daG3ky3/bcqWe4iSPoq4vz49NX6i+V/FTwlrK6OD9ez/9QF0Dzc/sXGfNTMz0439ZrmlzRVOXANfrg+W0kY37usJFGfS+36xsMj4w3lnNXpvey9agS3XuHa4wxudLtvbGPeDnkSrcjLWzqOXX6H/S18p15s3J9eG84MTlvTP1Cfe3Zk453OSH2dpj9Mc3R1p6uhBgvQZ38nL9kJiMa9R5dovuj7L0NnF4O1DPc9D3oa48WVpoHFI13uLmLox3tsDwxvDC95jfeGNvlp2ZMy4e/1aLtNVxdnDejFw8fxUG5/FyjrOYnu4h6pxKVL4rlUs7h5UA9w1m/g7569/pK8wdIwZtVeRmnVp4IPqdqfIiUuzjaqOzao4WV+o1rT1caFVwtHj6iz9+cHZ+f3N9trTwxGVwsaj7Nou0WpERTBUrhP9K0luh+YV+Z3v/7s/3PeMXLoVa+066wqWc4a/0b4t5amjHjex9wtayuj2jWZscbJ9YY4eyt2vtUqnH7+OzsTOs6Mz67VP+Ey9/7pMtyCqb1GPK4Lbcctiscdwee96ZnPyiV/aIV1RgUhiyRtsvtSrS5sMXBxAukcb/x2dn2LxyfeoYTz/f9o/4vAAAcY3zXDQAoR9ADgHIEPQAoR9ADgHIEPQAoR9ADgHIEPQAoN9jn421sbHRwr2w229kd2c8x2k82m+3+0KFQjeznkHt1f+jkYEQPAMoR9ACgHEEPAMoR9ACgHEEPAMoR9ACgHEEPAMoR9ACgHEEPAMoR9ACgHEEPAMoR9ACgHEEPAMoR9ACgHEEPAMoR9ACgHEEPAMoR9ACgHEEPAMp5vu/383i2yRvPn49+hkbPC5YzYnlgIFg+eTJYPnMmWD57Nlh+5bVg+dUvBMvnzottfitYPv074hxywfKvfy9YXvpGsFys7e4vX/jvYPm1D3eCff4kWD/w02A5sxE8fd5H4ql8IZY/CxbNlli/Ldb7DssRufKfW23XJ2fO2F5Uo42sxtOnxPJpsSwq81VRja9/Wax/I1iW1Xjqd8XBLgaLH309WP7xW8HyH4tq/O0fBhX46o+D9afWLdX4C1GNH1uq8XNxPpuWatw17amuxp5iRA8AyhH0AKAcQQ8AyhH0AKAcQQ8AyhH0AKAcQQ8AyhH0AKDcYNwnAADGeJblvjZ0qsWIHgCUI+gBQDmCHgCUI+gBQDmCHgCUI+gBQDmCHgCUI+gBQDmCHgCUozMWSDy6Q9EdRvQAoBxBDwDKEfQAoBxBDwDK9fvD2Gw22+cjImmSUwPJORPEJSU10O+g39jYsNySiocbxl4D/X/JUY1ITjX2FJduAEA5gh4AlCPoAUA5OmOBxPOO3iTBu3fjOyyjU4zoAUA5gh4AlCPoAUA5gh4AlCPoAUA5gh4AlCPoAUA5gh4AlKNhCki7RPckyW6uRJ9oojGiBwDlCHoAUI6gBwDlCHoAUI6gBwDlCHoAUI6gBwDlCHoAUI6gBwDl6IwFEi8NHaGeZdnl326bC9F230TMndhXjOgBQDmCHgCUI+gBQDmCHgCUI+gBQDmCHgCUI+gBQDmCHgCUo2EqBWztIS5tKUzkBhx/jOgBQDmCHgCUI+gBQDmCHgCUI+gBQDmCHgCUI+gBQDmCHgCUI+gBQDk6Y+EsfROwJUWPH/nYntiwB+719noxogcA5Qh6AFCOoAcA5Qh6AFCOoAcA5Qh6AFCOoAcA5Qh6AFCOoAcA5eiMVcSzLLtsQw9hilknA46qKlyqTi7L8advWUYYjOgBQLleBP36w1KhUCgU7q32YOdAKFQj0IugX1344PL9SqVyy7z3cD363QMhUI1AT67Rj90ojxlj1p9/+OaFob11ly5dqi88fvw4+iPiWMlms/07GNWIQ/W1GuPTow9jV+8V3n3/7VuVxu/7r6iNjQ3LXVLxcMPYa6BnLzmqEVZ9r8Z49OjD2LEblUplfKXEu2XEj2pE2kUf9OsPS3zuhYSgGgHTi0s3Q1e/faFUKLxrzFvful8eOvoOQM9QjYDpzTX6oavlytUe7DfVXBqgbOu7aVExDusTTUU1JuGRd2meClt1YZukbI+D7dzCbq8XDVMAoBxBDwDKEfQAoBxBDwDKEfQAoBxBDwDKEfQAoBxBDwDKEfQAoBxTCcbDqZXPO3q9tbdQrh8Qy7sOB05CHyakmDo5nQqhmw7YAXmDOJpLlSIMRvQAoBxBDwDKEfQAoBxBDwDKEfQAoBxBDwDKEfQAoBxBDwDK0TAVD+vMfV20n/hi2ZNP7I7lAC7TB0q0q0TEE09C2Bn6eqGpW66p0iwnmjl62Rdtek3VKJuhmvZp6Q+k6qLAiB4AlCPoAUA5gh4AlCPoAUA5gh4AlCPoAUA5gh4AlCPoAUA5gh4AlKMztscsPX4Dcr2l69X3LF2sYgI2fzDYkXdCbHPSMknbQPvV9CImWWRPiNiRrI+dpqqzLFu6Xs2gqMYTohpPim12ZSWLk5A927Jj1vYPtq13mpnTYXu9GNEDgHIEPQAoR9ADgHIEPQAoR9ADgHIEPQAoR9ADgHIEPQAoR9ADgHJ0xnahi27SU2J72Ta4a+k/9K39h+LOp+XpiAOI+3qy/1AuS3TG9lFsD7ZsUHXqhpX92JZqPCXuvC33Iw4mK9ZWjVRg1BjRA4ByBD0AKEfQA4ByBD0AKEfQA4ByBD0AKEfQA4ByBD0AKEfDVA9YGqlks9IZsbwjGqN25bKYGnD3lNjladGuctYyJ6GYyM2TrSu2thRaVPrIj+jR9m2/OCx7YvkzS8teUzWKipLVuHtGtOOJSmuark9OKyimD/Soxn5hRA8AyhH0AKAcQQ8AyhH0AKBcvz+MzWazfT4ikiY5NZCcM0FcUlID/Q76jY0Nyy2peLhh7DXQ/5cc1YjkVGNPcekGAJQj6AFAOYIeAJSjM7YHHDpjXxE9hJtiYrZtMRnbjuiA3TkbLGdelQcL/qv2TopJ3bZE9+yOOAn6DxPAO3oTO4dn0NYxKyswIzpUPxGbb4p+7G3RAbstqnFQVuOmuLP4h2VkN6yoRk8c1/ctlenC0hIe2fa6MKIHAOUIegBQjqAHAOUIegBQjqAHAOUIegBQjqAHAOUIegBQjqAHAOXojHXg0rNn61cUfYAZ0Q17TvQTvhD9h5+fCZZfngsa+AY+b9/MJ2fvzLyUs3eKk9gV95V9knJHdMn2U9jOTIdnx3eZM1Z2xopqfENU46eiN/tzMR/s6VeCbQZeE5Umdi+7YTNbtmqU52Z5IGxVik4xogeABKmVJ4rVg+s8z/O8Azc4IugBICmqRW/4+sqBtXcXptd8318yk51FPZduACBKD976+JBbr/3odfuNVTPlr41M3G1eW3tmpq/kjDH5qZk7z2omnwt7SgQ9AETgwTca+X7WbTNjrv1XS+jn83lTe9Z6l7WnT8yVrs6NoAeAKJzt1SfHwyOjB8I/HK7RA0AUzoT/cZO7aBYe1Ywx1cX50Yuhr9sYgh4AonHKC/1zhGpxolwzxuRvTi8Me543aZbm8p2cGpduACAC/qmjt3GRKy3P7S3m55bzjXV+qYt9EvThNM19JpdFG4hvaZIaEG0p5z4Llv9XtJ+88WqwfPJzeeTgvdep08GBBz4PljNbwdZywjbPNmEbTVIJ0IPeKWuTVFP7nqiW10Sl/UpcT/iSaNk7+VIeIFi/K4alAy/FZJai8p2qUTqmlXn0CD02BD0ARMA/efQ2cSHoASAKJxnRA4BqjOgBQLsTcZ+AHUEPABHwT3DpBgBU8xnRA4BuPh/GAoBuSR7R8xUIABAB/4QX9ufAPmwTjDTW178RITxG9IJDy56t57CpM1b0BBrRDTsgumHP/TpY/v4Xg+Uvf6n9u7/N08Hy6c+CbQZFL2JG9j02TdjWfjm57zPTpJsmUGtvtqUaM6IaB0U1vv4iWP6PoaAu5ISXvhgTbp4Wfdqfin1uta9Gz1KN1go8np2xfvdpWp9gZDlXLXrFqh98rU1jfa08cbda6uDrbgh6AIjAn/313nDs/j98fshm7/zVadtN3U8wYkPQA0AE/vkfG98HdOjfWQabGfPnf9n0RWjWCUbycw+eTXjeyvjs2nJH317JNXoAiMDuidA/LYZHRtvuuVaeuGYe+L7/wFzr7Co9QQ8AEfAHQ/+0OGSCkfqvuYujK0/XOjg3Lt0AQAR2u++Mzd+cvjPsXTdmZsnPG2OqxYlnN5dLudJt43meMfs3hEXQA0AEdiNI05YJRvYnHsnP+f6c5T4uCHoAiEAEI/qeIegBIAJRjOh7JcGn1ne+5Rfb9IG7lrYUX0zS5ou2lIxokjrzUbD8VTF52/fOB4OCX5wOln/zk+DA58Skbie3xbSCsmGKJqljoukZsVRa0yYOTVK7sgJF05MR1TggqvHcL4Plr4m/93uUDc7uD0SVZl8P1r8iWvZObAfrZcuerEYvbDPU8Wme2knwVyAQ9AAQAUb0AKDcDtfoAUA3RvQAoNw21+gBQLfdQS7dAIBq2wlOU77rBgAisD0Y+ueAXk08QtADQAS2T3hhf1p3UZ9gxPeXzKSM+lr52tPbvu/7a9MLd6utd3KR4DcbAHB8lL+xN27+ix/sHrLZP33NOry2TTyy9nTUPPW8SWPGZ9eWOzk3gr69psZSSzfsruhElb2Iu2J6Gf+TYDnzcbB8SvQffkEc6+uid/HFq8HyD88E//m/OBes/0R8/vOZqJ+XYqywI5ZtMwz2052NmA6cfJYP82y92U3dsKI3W1bjjuyGFVMGZn4VLJ85GSyfF/ucENX74lxwck9fCdZ//MVg/f8NBOs/FdV4UpyznF1pwNKz3c/PNP/+l0dv42jmh43H7tA/vwk2M2b+q02hb514xMybKd+fM6ZanCjXlkuhZ54i6AEgAptdp+nwyOiz9rfMTHU0sdQ+l2v01WKnnwAAUaMakVCbJ7ywPy17sE08MjzyZLFxab5lQhJHLkGfn3tgrh38HNhq/WGpUCgUCvdWOzgh4FBUIxLq5UDon1b5m9MLw57nTZqlub2JR8o1Y3KlByN3PM/zvDsjN3s4Z2yutOz7U4tuf9yzuvDB5fuVSuWWeZcXF6JHNSKRXp4I/XNArrTs+77vzzXmG9m7Ht9Y38HleWNMqGv0+Tnfr5UnPG9lb8XMUuN0pPXn5vI3h4wxY+Nvv/d83YwNGWMuXbpUv/Xx48cdnSf0yGaz3e+EakQkIqnGuk8T/IlniFOrFr3JJ7Nrvn/4fyk/ef6h+Wbryv1X1MaG7U8uInu4kXC2Ggj1kqMaEYlIqrHuxbH/9spaeWL4+uiS06yFX7nw5vMuTwo4BNWIRPromI/oq8Vr5sFRQ6d9QxfMB99dv3p1aHXl/TfHb3R1dkArqhEJ9T8HP1xNDJeg35+J3M3Y9OX33il8x5i3b1XGOj0voD2qEQn15e2jt2nVr2827sWbjaGr5crVHuy3F5x6Dh26YbfFPK47nwbLcmZOT/Qfyv/7T8s5YEX37DkxS+eOuK+c38DPtF9ukrQrh7/Rz4Md12q0bmOpzB2RMrZq3BHVNSAiZlDs56zopD0lukZfFy2tO6Kv21qNllbXpn9iEirzjcj2dG7r6G1aHeegB4DUOdtB0PcLQQ8AEThF0AOAbic24z4DO76PHgAicGI79M8BtolHGjcy8QgAxGhwM/RPK8vEI8YYY2rla9dXDtzD9dw6vSMAIPDvjeaO/PcP26z6detNtolHjDG18rWF6dmZhQ7PjaAHgAj8yff2Fg5vnNrfzBjzb7/fdJN14pFa+drC9IPli3cXLN9XfxSCHgAiMND1X93YJh6pPVpYWVkZ9owx5kn5CjNMWfmW5aZtLM1TskmqqS1FNkyJ6QO3xARsnqUhIiMuz3miqWpQNEkNiiYpXz5RcsDgMgNbEtpSpL42TB1X1gksxXJTBYqKaqpGMX2gJ6tI7CcjtvdEU9UJOe9f2Go0Xazvp+gapjJdB3194pFSKVddnB+dCr7LKVda9kvGmGpx4tnNjr6omA9jASACma3QP60sE490Ly0jegDoKS+ChqnG2H1Pyzc7hfyiJ4GgB4AIdH/ppncIegCIQBQj+l4h6AEgCgQ9AOjGiB4AtCPoAUA3RvQAoB1Bnyy26QMtvYg7ojN2W3TGbokJ2wbFBGwZy4PqizoYEBO8ZUT/oeyklX2Mnks3bBL6DF38YdwnEDfPNs2ew2SWsht2S3TDbonuVjlNYEb2RMoKF/cdFL3cGTFNoJz8sqkCxbLt39IkyZX5R5HtySfoAUC5BAc9X4EAABHwN0P/HGCbeKRa9Dz7jCRHI+gBIApb4X9aWCYeqZXvmCXf9/212Sd3OvryGy7dAEAE/uVv9ham/+6wzRb+1nqTbeKRXGm5/lWWuYujo6aTb68k6AEgAn96O/Rm/3qn6SbrxCN7qsU7IzeXOzg1gh4AorDbs4lHjDHGVIve4pQ/18l4nmv0ABAJfyv0T4v6xCPGmOri/OhFEem18oS3OOXPdfglxQQ9AERidzP0TyvLxCPVu9dXzPyk53me19lMJFy6AYAIdH/pxjbxSG7O9+es93GRxqBvmj/WoRu2aZ5Y2YsoHryMZeL3XXlf0bs4KGbyzNi6YTPtl536DJPci5hKXshnZFdUprU3W1TjSznvq6xGuR+RRIMO1Sh7vJvOP2NZL6WvAtuM0BMjjUEPAJHbSXBnLEEPABHYYUQPALpFcY2+Vwh6AIjANiN6ANCNSzcAoJycoCJpCHoAiMA2QQ8Aum0S9MliaZLalU1SDi0qGcv3R8j9yInfmqYblG0por2laZ8ubSk26WtXUcBlKkFZmVtyckrRACXtOkx+OSimDLQ1SXmWaqcy921anoIk4LtuACACn30W+ucA2wxTtvWuCHoAiMCLX4f+aWWZYcq63lkqL90AQNR+8ctu92CbYcq23h0jegBIhLWnT0Ktd0fQA0AiDI+MhlrvjqAHgESwzTBlnXnKGUEPAMlgmWHqwPrQ+DAWABKi/QxTB9aHxogeAJRLzYhe9hyK3jzZi7gj+w9lP6FDh6rsXdy29CIOWKYezNj271nWQ6mmiS0dJrmUfdebtqoW1Tgoq1H0ZjdVpm0CS6GraqSS48CIHgCUI+gBQDmCHgCUI+gBQLl+fxibzWb7fEQkTXJqIDlngrikpAb6HfQbGxuWW1LxcMPYa6D/LzmqEcmpxp7i0g0AKEfQA4ByaWmY8i2/2NpStkVbiifaUpp2I9tSxPYDcoI32Rjl0CTl1IpCy4lSskptTVK2arG1/g3KahQvd5fKtFVa6AKkYuPGiB4AlCPoAUA5gh4AlCPoAUA5gh4AlCPoAUA5gh4AlCPoAUA5gh4AlNPcGSt7BW0dp7Z+QrN9YNMD29umDxxw6YCV6+UBPMt6aCIntpTLshvWto3LFIOWarRVpuyMtb1SuqpGSjlujOgBQDmCHgCUI+gBQDmCHgCUI+gBQDmCHgCUI+gBQDmCHgCUI+gBQDnNnbE2vt9+vewzbLLdfpsB0YsYdj5Yp/5D+gkVaao6+cxaZjA2lvlgdy0zFbv0ZluX5flQmRoxogcA5Qh6AFCOoAcA5Qh6AFCOoAcA5Qh6AFCOoAcA5Qh6AFAuLQ1TtmkFXZqn5DYZOXmb2E9GtK44NUbRcpJitqqzNVLJaQU92TwlK80yraBL+55LwxSONUb0AKAcQQ8AyhH0AKAcQQ8AyhH0AKAcQQ8AyhH0AKAcQQ8AyhH0AKBcWjpjpbBdsnK9L3sLxTY7u+3XG8v2QBu2CpTLluptqmSxLKcebGqAdejfhhqM6AFAOYIeAJQj6AFAOYIeAJQj6AFAOYIeAJQj6AFAOYIeAJQj6AFAuTR2xkphu2SNpUvW1tMo0X6INmwV5bK9w36su3TpjHWoahwLjOgBQLleBP36w1KhUCgU7q32YOdAKFQj0IugX1344PL9SqVyy7z3cD363QMhUI1AT67Rj90ojxlj1p9/+OaFob11ly5dqi88fvw4+iPiWMlms/07GNWIQ/W1GuPTow9jV+8V3n3/7VuVxu/7r6iNjQ3LXVLxcMPYa6BnLzmqEVZ9r8Z4RHbpZvVeoVAoFEr198djNyqVyvhKiXfLiAPVCEiRjejHblQqN4wxZv1h6d6F8o2xqHYMhEY1AlL0l26Grn77QqlQeNeYt751vzx09B2AnqEaAWOM51tbg3rCdkXs/PnkXhFjorVo/exnSbkqehyr0UXYinXaXuaES4PVMXnV/PSnSanGnqJhCgCUI+gBQDmCHgCUI+gBQDmCHgCUI+gBQDmCHgCUI+gBQDmCHgCUS/tUgi762zuM9HKazDKqYzms9203hN0p4saIHgCUI+gBQDmCHgCUI+gBQDmCHgCUI+gBQDmCHgCUI+gBQDkapoA4RdVjZJsO0Lp/cYPTfWkbPM4Y0QOAcgQ9AChH0AOAcgQ9AChH0AOAcgQ9AChH0AOAcgQ9AChH0AOAcnTGAnHyrb+E3I+4b9OUhE4HdjmAWLa127psgzgwogcA5Qh6AFCOoAcA5Qh6AFCOoAcA5Qh6AFCOoAcA5Qh6AFCOoAcA5eiMBbSxdclaO1cd1jdtYumqtXX52g6FvmFEDwDKEfQAoBxBDwDKEfQAoBxBDwDKEfQAoBxBDwDKEfQAoBwNU4A2nm0aP4f1Tc1NlvXW40a0DSLHiB4AlCPoAUA5gh4AlCPoAUA5z/cT8XVy1o+PoE4yKu4wx70aw56/Z/swNpKzSbadnbjPoC/6/Vc3GxsblluyfT0PxMdWA9lsv2uAakRyqrGnuHQDAMoR9ACgHEEPAMrRGQuk0TH/vBnhMKIHAOUIegBQjqAHAOUIegBQjqAHAOUIegBQjqAHAOUIegBQjqAHAOXojAXSSH4FsfWrif32621dtS7bIBaM6AFAOYIeAJQj6AFAOYIeAJQj6AFAOYIeAJQj6AFAOYIeAJRLSsPUz3++ccit2Wx2Y+OwDRyxn+O1n7hQjexHGUb0AKAcQQ8AyhH0AKAcQQ8AyhH0AKAcQQ8AyhH0AKAcQQ8AyhH0AKAcQQ8AyhH0AKAcQQ8AyhH0AKAcQQ8AyhH0AKAcQQ8AyhH0AKAcQQ8AyhH0AKCc5/t+3OfQP5cuXXr8+HHcZxHgfNIsaY8256MYI3oAUI6gBwDl0nXpBgBSiBE9AChH0AOAcgQ9ACiXqqBff1gqFAqFwr1VzqRZ0s4nDZLzmCfnTOqSdj4apCnoVxc+uHy/UqncMu89XE/ImbybiGJOziOTHsl5zKnGFEhT0I/dKF8dMmb9+YdvXhiK80TWn5vL3xwyxoyNv/3h8wTUcmIemRRJzGNONaZBmoLeGGNW7xXe+c6b42OxnsRPnn8Y6/HbSsQjkzKJeMypxjTQH/Sr9wqFQqFQqr8LHLtRqVTGV0qxvif8yoU3Yzy6RSIeGfWoRjeJeGQ00R/0YzcqlUqlUr5qHpYScQnSmKEL5oPvrhtjVlfeT8K70/XEPDLqUY1Hohp7IVWdsesPS+9850fGvPWt++Wr8V4X3TuTt29VbiTh7WlyHpn0SM5jTjXql6qgB4A00n/pBgBSjqAHAOUIegBQjqAHAOUIegBQjqDvt1p5wpso1xq/VoueV6zGeUJIMaoxJfjzyhhUi96dkbXlUs5Ui97ilD+Xj/uMkF5UYxoQ9LGov6RuPpu4e3GZFxbiRTXqNxj3CaRTfm5p0fOGZ5b8UtyngtSjGvXjGn08as+ezMzMzC9yPRTxoxrV49JNHGrliWvmwfKVRxPDT29zURSxohpTgKDvv70XVilnTK3MiwuxohpTgaDvs1p5Ynhhem25lGv/O9A/VGNaEPQAoBwfxgKAcgQ9AChH0AOAcgQ9AChH0AOAcgQ9AChH0AOAcgQ9AChH0AOAcgQ9AChH0AOAcv8PPAsRFaabuiQAAAAASUVORK5CYII=" alt="plot of chunk reproduce_bivar_fig" /></p>
<p>Reproduce actual and estimated Spearman and Kendall correlation coefficient
results for <strong>Table 3</strong> in the text.</p>
<p>Actual Spearmans</p>
<pre><code class="language-r">print(round(actual_spearmans,3))
</code></pre>
<pre><code>## [1] 0.485
</code></pre>
<p>Estimated Spearmans</p>
<pre><code class="language-r">print(round(spear_est,3))
</code></pre>
<pre><code>## [1] 0.483
</code></pre>
<p>Actual Kendall</p>
<pre><code class="language-r">print(round(actual_kendall,3))
</code></pre>
<pre><code>## [1] 0.335
</code></pre>
<p>Estimated Kendall</p>
<pre><code class="language-r">print(round(kendall_est,3))
</code></pre>
<pre><code>## [1] 0.334
</code></pre>
<p>Reproduce quantile estimate results on EUR/USD and GBP/USD as presented in
<strong>Table 4</strong> in the text.</p>
<pre><code class="language-r">spread_data &lt;- 
  arrow::read_parquet(&quot;C:\\data\\eurusd_gbpusd_spread_2021_10.parquet&quot;)
percs &lt;- c(0.01,0.1,0.25,0.5,0.75,0.9,0.99)
hermite_ests &lt;- by(spread_data, list(spread_data$hr,spread_data$currency_pair), 
        function(x){hermite_estimator(observations = log(x$spread_bps+1e-8))})
quantiles_ests &lt;- t(sapply(hermite_ests,FUN=function(x){exp(quant(x,percs))}))
eur_usd_merged &lt;- merge_hermite(as.list(hermite_ests)[1:24])
gbp_usd_merged &lt;- merge_hermite(as.list(hermite_ests)[25:48])
gbp_all_hours &lt;- exp(quant(gbp_usd_merged,percs))
eur_all_hours &lt;- exp(quant(eur_usd_merged,percs))
dim(gbp_all_hours) &lt;- c(1,length(percs))
dim(eur_all_hours) &lt;- c(1,length(percs))
result &lt;- data.frame(currency_pair = rep(attr(hermite_ests,&quot;dimnames&quot;)[[2]], 
                each=24), hour_utc = rep(attr(hermite_ests,&quot;dimnames&quot;)[[1]],2),
                quantiles_ests)
result &lt;- rbind(result, 
        data.frame(currency_pair = &quot;EUR/USD&quot;, hour_utc = &quot;All&quot;, eur_all_hours))
result &lt;- rbind(result, 
        data.frame(currency_pair = &quot;GBP/USD&quot;, hour_utc = &quot;All&quot;, gbp_all_hours))
colnames(result) &lt;- c(&quot;currency_pair&quot;, &quot;hour_utc&quot;, paste0(&quot;p_&quot;,percs*100,&quot;%&quot;))
print(result,digits=1)
</code></pre>
<pre><code>##    currency_pair hour_utc p_1% p_10% p_25% p_50% p_75% p_90% p_99%
## 1        EUR/USD        0  0.2   0.3   0.3   0.4   0.4   0.5   0.6
## 2        EUR/USD        1  0.2   0.3   0.3   0.4   0.4   0.5   0.6
## 3        EUR/USD        2  0.2   0.3   0.3   0.4   0.4   0.5   0.6
## 4        EUR/USD        3  0.2   0.3   0.3   0.4   0.4   0.5   0.6
## 5        EUR/USD        4  0.2   0.3   0.3   0.4   0.4   0.5   0.5
## 6        EUR/USD        5  0.2   0.3   0.3   0.4   0.4   0.5   0.5
## 7        EUR/USD        6  0.2   0.3   0.3   0.4   0.4   0.5   0.5
## 8        EUR/USD        7  0.2   0.3   0.3   0.4   0.4   0.5   0.5
## 9        EUR/USD        8  0.1   0.2   0.3   0.4   0.4   0.5   0.6
## 10       EUR/USD        9  0.2   0.3   0.3   0.3   0.4   0.5   0.5
## 11       EUR/USD       10  0.2   0.3   0.3   0.4   0.4   0.5   0.6
## 12       EUR/USD       11  0.2   0.3   0.3   0.4   0.4   0.5   0.5
## 13       EUR/USD       12  0.2   0.3   0.3   0.4   0.4   0.5   0.5
## 14       EUR/USD       13  0.1   0.3   0.3   0.4   0.4   0.5   0.6
## 15       EUR/USD       14  0.2   0.3   0.3   0.4   0.4   0.5   0.6
## 16       EUR/USD       15  0.2   0.3   0.3   0.4   0.4   0.5   0.6
## 17       EUR/USD       16  0.2   0.3   0.3   0.4   0.4   0.5   0.6
## 18       EUR/USD       17  0.2   0.3   0.3   0.4   0.5   0.5   0.6
## 19       EUR/USD       18  0.3   0.4   0.4   0.6   0.7   0.8   2.0
## 20       EUR/USD       19  1.5   2.2   2.8   3.2   4.4   6.2  13.0
## 21       EUR/USD       20  0.4   0.5   0.6   0.7   1.9   3.3   4.9
## 22       EUR/USD       21  0.3   0.4   0.5   0.6   0.9   3.3   4.3
## 23       EUR/USD       22  0.2   0.4   0.4   0.6   0.9   3.3   4.3
## 24       EUR/USD       23  0.2   0.4   0.4   0.6   0.9   3.3   4.3
## 25       GBP/USD        0  0.4   0.5   0.6   0.7   0.8   0.9   1.1
## 26       GBP/USD        1  0.4   0.5   0.6   0.8   0.9   1.0   1.2
## 27       GBP/USD        2  0.4   0.5   0.6   0.7   0.9   1.0   1.1
## 28       GBP/USD        3  0.4   0.5   0.6   0.7   0.9   1.0   1.1
## 29       GBP/USD        4  0.4   0.5   0.6   0.7   0.8   0.9   1.0
## 30       GBP/USD        5  0.4   0.5   0.6   0.7   0.8   0.9   1.0
## 31       GBP/USD        6  0.3   0.5   0.6   0.7   0.8   0.9   1.0
## 32       GBP/USD        7  0.4   0.4   0.5   0.7   0.8   0.8   1.0
## 33       GBP/USD        8  0.4   0.5   0.6   0.7   0.8   0.8   0.9
## 34       GBP/USD        9  0.3   0.4   0.5   0.6   0.7   0.8   1.0
## 35       GBP/USD       10  0.4   0.4   0.5   0.7   0.8   0.8   1.0
## 36       GBP/USD       11  0.3   0.4   0.5   0.6   0.7   0.8   1.0
## 37       GBP/USD       12  0.3   0.4   0.5   0.7   0.8   0.8   1.0
## 38       GBP/USD       13  0.3   0.4   0.5   0.6   0.7   0.8   1.0
## 39       GBP/USD       14  0.3   0.5   0.5   0.7   0.8   0.8   1.0
## 40       GBP/USD       15  0.4   0.5   0.5   0.7   0.8   0.9   1.0
## 41       GBP/USD       16  0.3   0.5   0.6   0.7   0.8   0.9   1.0
## 42       GBP/USD       17  0.4   0.5   0.6   0.7   0.8   0.9   1.0
## 43       GBP/USD       18  0.5   0.7   0.8   1.0   1.1   1.4   4.2
## 44       GBP/USD       19  2.0   3.0   4.2   6.9   9.6  16.0  37.5
## 45       GBP/USD       20  0.5   1.0   1.1   1.4   3.3   9.7  38.0
## 46       GBP/USD       21  0.4   0.7   0.9   1.1   1.4  10.5  40.1
## 47       GBP/USD       22  0.5   0.6   0.8   1.1   1.5  10.2  39.6
## 48       GBP/USD       23  0.5   0.6   0.8   1.1   1.5  10.2  39.6
## 49       EUR/USD      All  0.2   0.3   0.3   0.4   0.5   0.7   4.0
## 50       GBP/USD      All  0.4   0.5   0.6   0.7   0.9   1.5  20.8
</code></pre>
<p>Reproduce sequential quantile estimate results on EUR/USD and GBP/USD as
presented in <strong>Figure 6</strong> in the text along with sequential Spearman
and Kendall correlation estimates presented in <strong>Figure 7</strong> in the text.</p>
<pre><code class="language-r">eur_data &lt;- spread_data[which(spread_data$currency_pair == &quot;EUR/USD&quot; &amp; 
            spread_data$time_stamp &gt;= as.Date(&quot;2021-10-07&quot;) &amp; 
              spread_data$time_stamp &lt; as.Date(&quot;2021-10-08&quot;)),]
gbp_data &lt;-spread_data[which(spread_data$currency_pair == &quot;GBP/USD&quot; &amp; 
            spread_data$time_stamp &gt;= as.Date(&quot;2021-10-07&quot;) &amp; 
              spread_data$time_stamp &lt; as.Date(&quot;2021-10-08&quot;)),]
eur_data &lt;- eur_data[order(eur_data$time_stamp),]
gbp_data &lt;- gbp_data[order(gbp_data$time_stamp),]
h_est_eur &lt;- hermite_estimator(exp_weight_lambda = 0.05)
h_est_gbp &lt;- hermite_estimator(exp_weight_lambda = 0.05)
h_est_bivariate &lt;- hermite_estimator(est_type = &quot;bivariate&quot;,
                                     exp_weight_lambda = 0.05)
output_eur &lt;- rep(NA,nrow(eur_data))
output_gbp &lt;- rep(NA,nrow(gbp_data))
output_spearman&lt;- rep(NA,nrow(gbp_data))
output_kendall&lt;- rep(NA,nrow(gbp_data))
for (idx in seq_len(nrow(eur_data))) {
  current_obs_eur &lt;- eur_data[idx,]$spread_bps
  current_obs_gbp &lt;- gbp_data[idx,]$spread_bps
  h_est_eur &lt;- update_sequential(h_est_eur,log(current_obs_eur+1e-8))
  h_est_gbp &lt;- update_sequential(h_est_gbp,log(current_obs_gbp +1e-8))
  h_est_bivariate &lt;- update_sequential(h_est_bivariate, 
                        c(log(current_obs_eur+1e-8),log(current_obs_gbp+1e-8)))
  output_eur[idx] &lt;- exp(quant(h_est_eur,p=0.5))
  output_gbp[idx] &lt;- exp(quant(h_est_gbp,p=0.5))
  output_spearman[idx] &lt;- spearmans(h_est_bivariate)
  output_kendall[idx] &lt;- kendall(h_est_bivariate)
}
output_res_df_eur &lt;- data.frame(time_stamp = eur_data$time_stamp, 
                          median_spread = output_eur, currency_pair=&quot;EUR/USD&quot;) 
output_res_df_gbp &lt;- data.frame(time_stamp = gbp_data$time_stamp,
                          median_spread = output_gbp, currency_pair=&quot;GBP/USD&quot;) 
output_res_df &lt;- rbind(output_res_df_eur,output_res_df_gbp)
output_spearman_df &lt;- data.frame(time_stamp = eur_data$time_stamp,
                                correlation=output_spearman, type=&quot;spearman&quot; )
output_spearman_df &lt;- output_spearman_df[seq(1,nrow(output_spearman_df),by=10),]
output_kendall_df &lt;- data.frame(time_stamp = eur_data$time_stamp, 
                                correlation=output_kendall , type=&quot;kendall&quot; )
output_kendall_df &lt;- output_kendall_df[seq(1,nrow(output_kendall_df),by=10),]
output_correl_df &lt;- rbind(output_spearman_df, output_kendall_df)
output_correl_df &lt;- output_correl_df[order(output_correl_df$time_stamp),]
output_res_df_plot &lt;- output_res_df[seq(1,nrow(output_res_df),by=10),]
ggplot(output_res_df_plot,mapping=aes(x=time_stamp ,y=median_spread,color = 
        currency_pair)) + geom_line() + xlab(&quot;Timestamp&quot;) + 
         ylab(&quot;Median Spread (bps)&quot;)
</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (`geom_line()`).
</code></pre>
<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5" /></p>
<pre><code class="language-r">ggplot(output_correl_df,mapping=aes(x=time_stamp, y=correlation,color=type)) + 
  geom_line() + xlab(&quot;Timestamp&quot;) + ylab(&quot;Correlation&quot;)
</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (`geom_line()`).
</code></pre>
<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5" /></p>
<p>Benchmark hermiter vs tdigest, updating with 1e6 observations. Reproduces
<strong>Table 6</strong> and <strong>Figure 8</strong> in the text.</p>
<pre><code class="language-r">obs &lt;- rnorm(1e6)
bench_res &lt;- microbenchmark::microbenchmark(
  t_digest = tdigest(obs),
  hermite_N_10 = hermite_estimator(N = 10, observations = obs),
  hermite_N_20 = hermite_estimator(N = 20, observations = obs),
  hermite_N_30 = hermite_estimator(N = 30, observations = obs),
  hermite_N_50 = hermite_estimator(N = 50, observations = obs),
  times = 20
)
autoplot(bench_res, log = TRUE)
</code></pre>
<pre><code>## Coordinate system already present. Adding new coordinate system, which will replace the existing one.
</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAA4VBMVEUAAAAAADoAAGYAOmYAOpAAZrYzMzM6AAA6ADo6AGY6OgA6OmY6OpA6ZmY6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmtv9uTU1uTY5ubm5ujo5ujshuq+SOTU2OTW6OTY6ObquOjm6OjsiOq+SOyP+QOgCQOjqQtpCQ2/+rbk2rbo6r5P+2ZgC2kDq2///Ijk3Ijm7IyI7IyP/I///bkDrbtmbb25Db/9vb///kq27kq47k5P/k///r6+v/tmb/yI7/25D/5Kv/5OT//7b//8j//9v//+T///9apXUQAAAACXBIWXMAAAsSAAALEgHS3X78AAARnElEQVR4nO2dAXva1hlG3a2l69Ytsq1utZMYJ1mrbnXpgl3SLng0mJRa//8H7epKYDBgLPi+lxfrvc3jgOAc6eZwJey24SDXaOQ42PUBaOxmKHxDh8I3dCh8Q4dD+F/vjYUN60ZtAEJwKAwIhd9yKLzC4xQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQK70u0imG+UwOFwrsSrWIe69Ir/BMNX6S33amBQuFdiSr84qKfvQIo/NMNP7/oi+phy+Y7rXkUToTCrx6tmemUa7yMHu9vvtOaR+FEKPzq0ZqbUOuu+tMOP2wv3/hxcHd39LyX55edePv2IjnshC/pEw0/P5oWPs/Hb2bDn6bT8ONvSqibKbzlUTgRD4R/eXrUG58nx4Phi6OrcOcqOeoN2/0kjRvL8GchcxV+dBq2XnfiC2b2pLi/48HwsKNwHUvDHw/6WT8LIYdpvJPm/WzYDis+bozPGZ2NX/eq8GHT6NvLzuShrV+kWvGuxAPh2yF0N0mSNNwqf1Xh48YqfD5Mq/ARuX7C4Rv05i6u+Dy/H76fTZ4TwufdwzJ8cR7Inuw1vkHfzsXQ4XKetOfC316kceM0/PjV9F19mj/Rd/UzP6mr2j/h8FuOrY+VKPy9H9m2mvwj2/AePkkOOwu3n2B4/UuaWmPrYyUIH8/p+teyjQuv/xCjqeFpFQoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAq/mmjNjcUnP/TYxjtFKRR+FRF6zh1Na2Hcf6j23jY+TAOFa/hhe/nGj4O7u6PnvTy/7MTbtxdJWn5hCF/3dbpx/YaEz/Pxm9nwp+k0fHj+ZSd86Wb7GH42f60XAHv4akJ1wr88PeqNz5PjwfDF0VW4c5Uc9YbtfpLGjWX4s5C5Ch/W/A+96058wdw/08LHNrtfvCzs/1g116Xhjwf9rJ+FkMM03knzfjZshxUfN8bnjM7Gr3uT8OPztHgRVA9t/bLGr/jqD8n7MA0U3qf6ftZNkiQNt8pfVfi4sQqfD9Ppig9Pud7T8Jsk3/QwDRT+4ftZeWsufD+bPCeEz7uHZfjy5MByjZ89vz3iVFh7X1scpoHCP3y4nCftufC3F2ncOA0/fjV9V388YHlXH8f6qvoBTs0z4yPG1seqn9y5EpuGH52GC311kp+9rfAIhVY8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FA0MHzrbjySqL8PfkUTw093sBhf4WsQ+xt+En+BaM2NDfZhcJjOCtfww/byjR8Hd3dHz3t5ftmJt8fnyVHv9iJJgeGr9lXfSeu5hzfYh8FhOivw4UPfN7PhT9Np+H6W99sB6mbQ8LP5lz2wwT4MDtNZ4Rv+5elRLyzj48HwxdFVuHMVVvSw3U/SuLEMfxYyV+ELJLvuxBfM8ggWo67X6zieyFga/njQz8IyHraHabyThkU9bIcVHzfG54zOxq970/DhocvO5KGtX6S1VvzKoRW/gnggfDuE7iZJkoZb5a8qfNxYhc+H6SR8eA3k1zsIP/9m7t4TFH4FsSZ8PytvzYXvZ5PnhPB597AMH9/ooa/xc+/bI3HvZaDwK4g14cPlPGnPhb+9SOPGafjxqzJ8cR5oI9/VL3TV9/E1iNXhtxxbH+van9wtLGaFr0FsGn50Ghb45CQ/c9s7/K4JDkUDV/yuCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ6FwsMJDoXCwwkOhcLDCQ7FPoZvLRlek3MgOBSu4Yft5Rs/Du7ujp738vyyU93rZ/ntRZKuDF9WXpQu739neNTrxOaPo/5oSPg8H7+ZDX+a3oXvJlkBdbOV4ZcKF18AC2Pp01z+OOqPJxj+5elRb3yeHA+GL46uwp2r5Kg3bPeTNG4sw5+FzFX48U9hxV934gtm6cLO14WvNUxljR1Lwx8P+lm/WMTDNN5Jw7l82A4rPm6MzxmdjV/3Zk/1l53JQ0tecrbhXdZB/fEEV3w7lOwmSZKGW+WvKnzcWIXPh+ls+Ostwq8808+fPlZf6RW+BrEmfD8rb82F72eT54TwefdwJvzD1/jlb+5WvGmbMTzuvZ3C1yHWhA+X86Q9F/72Io0bp+HHrx77rj6Ox343p2/nfInV4bccWx+rwrsSm4YfnYYLfXWSn72t8AiFVjyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJzgUCg8nOBQKDyc4FAoPJxwULQU3npyDoSD4oG/gd9upwq/JeGgUHjzyTkQDgqFN5+cA2GveOjDVux2qvBbEvaK1rIP1DLfqcJvSdgrFN5+cg6EvULh7SfnQNgrFN5+cg6EvULh7SfnQNgrFN5+cg6EvSKEr11e4eGEvaK19AOSrXeq8FsS9gqFt5+cA2GvUHj7yTkQ9gqFt5+cA2GvKMLXLa/wcMJeEcLXXvIKDyfsFQpvPzkHwlzRUnj7yTkQ5oqie+2LvMLDCXNFDF93ySs8nDBXKLzD5BwIc4XCO0zOgTBXKLzD5BwIc4XCO0zOgTBXKLzD5BwIc4XCO0zOgbBWtKrw9corPJywVrSqPy6Ft5ycA2GtUHiPyTkQ1gqF95icA2GtUHiPyTkQ1gqF95icA2GtUHiPyTkQ1opp+FrlFR5OWCsm4euVV3g4Ya2Yhq91st9R+I+Dya1+NmyveHTrY1V4y51ahB+/mQm/8tGtj1XhLXdqEb6fpGXi8+RFWPHj88N/ZuH28SB8OerFR1ut1hqJRjlaS24Bx0YrPiz3bgjfz24vsnC7uJXf/k8rvtbYpxU/SXvZidf4+Fs3SZI0rPjDjsLXGvsYfrriw2+Ti3048yt8nbFP387dXty7xoffwpek3U/CNX7y6NbH2qzw9f62O4rv4+OKX9y89bE2LLzzTm3Cj07DJf2wU96Jb+gVfsOxX+EfM7Y+VoW33KnCb0lYKxTeY3IOhLVC4T0m50BYKxTeY3IOhLVi8rNthbecnANhrtD/UOEwOQfCXKHwDpNzIMwVCu8wOQfCXKHwDpNzIMwVCu8wOQfCXKHwDpNzIMwVCu8wOQfCXKHwDpNzIMwV5V9wqPCmk3Mg7BX6my3tJ+dA2CsU3n5yDoS9QuHtJ+dA2Cv099XbT86BsFfoEyrsJ+dA2CsU3n5yDoS9QuHtJ+dA2CsU3n5yDoS9Qp80aT85B8Jeoc+WtZ+cA2GvUHj7yTkQ9gqFt5+cA2GvUHj7yTkQ9gqFt5+cA2GvUHj7yTkQ9op6/2f8pjtV+C0JB4XCm0/OgXBQKLz55BwIB4XCm0/OgXBQtHYyU4XfcuxEofBwgkOh8HCCQ6HwcIJDofBwgkOh8HCCQ6HwcIJDofBwgkOh8HCCQ6HwcIJDofBwgkOh8HCCQ8EcfuuB+HAejo9M2uFRKPwuh8LPDYUHDMbwGoCh8A0dCt/QofANHWThby+StPziuo/DjvM+1o7iQ1kBc109yMIP2/llJ3xZ9nl2VmP8Tbkjz32sG90kKw9hZ8dBFj6sxx9615188cPp7cboNDkeOO9jzRj/FFZ8PISdHQdb+PF5WnxmsecfRnCPvnXex9oRwsdD2NlxsIXPIatghyutGlrx8yN+Gr3zda/Yx+6urTMHoWv83Qhvco8H/u/qd/huuhp6V6+xm6HwDR0K39Ch8A0dCt/QofANHY0Mf/P5QRif/PvL9/cf+XDw6WTbzZe/xH8WnnN//P7dSfX7wYntcXqORoYP492zpZs/fDZz5+Yx2e/C5/mPCk8/ivAh7F++PvjbdwfPwko/iMlD+Jtq22TF//e7g/CE6hnhXPGHt/m7YsvNX78qtrw7+OPXJ7+Xz1F4/lGF/9P3N+FXXNmxWhF+uq385+fP8t/+8fYmPuO3v3+fv/vs5ou34UbxNWz/4u3N5ycf4nMUfg9GFf7L9zfFr5+La35x8i/CV9sm4X/5vFjYH+IzbuKpv7ge/HgSbv/+r+/fxYV+E5+j8Hsw7oWfXNqXhH9fnN9Pyov/qvDxGnCi8Hsw5sOHU375Fm1J+P8UmZ/dxGcUp/oPn/5Snupj+OKE/9XJu/gchd+DMR/+/eybu/sr/seD4nu8e2/uTvIyfLj9yZ/DWo/PUfi9HXPfztUeCr+3Y+YHOLWHfoCjsQdD4Rs6FL6hQ+EbOhS+oeP/Zke0u2xfNZ4AAAAASUVORK5CYII=" alt="plot of chunk benchmark_updating" /></p>
<pre><code class="language-r">print(bench_res)
</code></pre>
<pre><code>## Unit: milliseconds
##          expr     min       lq     mean   median       uq      max neval
##      t_digest 97.6876 99.12625 99.80952 99.52710 100.5774 103.0305    20
##  hermite_N_10 23.5763 25.40620 28.20219 25.97210  32.3442  35.0783    20
##  hermite_N_20 33.4534 34.17450 37.30006 35.13305  41.1298  43.0070    20
##  hermite_N_30 40.9998 42.81730 52.13190 46.55295  49.8021 165.2355    20
##  hermite_N_50 58.3004 59.04615 62.20795 60.01995  66.7448  67.4259    20
</code></pre>
<p>Benchmark hermiter vs tdigest, quantile estimation. Reproduces <strong>Figure 9</strong>
in the text.</p>
<pre><code class="language-r">obs &lt;- rnorm(1e6)
td &lt;- tdigest(obs)
h_est &lt;-
  hermite_estimator(observations = obs)
p_1 &lt;- 0.5
p_100 &lt;- seq(0.01, 1, 0.01)
p_10000 &lt;- seq(0.0001, 1, 0.0001)
p_100000 &lt;- seq(0.00001, 1, 0.00001)
bench_res &lt;- microbenchmark::microbenchmark(
  hermite_1_quantile =  quant(h_est, p = p_1),
  tdigest_1_quantile = quantile(td, probs = p_1),
  hermite_100_quantiles = quant(h_est, p = p_100),
  tdigest_100_quantiles = quantile(td, probs = p_100),
  hermite_10_000_quantiles = quant(h_est, p = p_10000),
  tdigest_10_000_quantiles = quantile(td, probs = p_10000),
  hermite_100_000_quantiles = quant(h_est, p = p_100000),
  tdigest_100_000_quantiles = quantile(td, probs = p_100000),
  times = 1e2
)
autoplot(bench_res,
         log = T,
         xlab = &quot;Algorithm&quot;,
         ylab = &quot;Time (millis)&quot;)
</code></pre>
<pre><code>## Coordinate system already present. Adding new coordinate system, which will replace the existing one.
</code></pre>
<p><img src="data:image/png;base64,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" alt="plot of chunk benchmark_quantile_est" /></p>
<pre><code class="language-r">print(bench_res)
</code></pre>
<pre><code>## Unit: microseconds
##                       expr    min      lq     mean  median      uq     max neval
##         hermite_1_quantile  253.8  386.55  532.057  409.20  466.25 10345.6   100
##         tdigest_1_quantile   10.5   12.45   24.500   22.20   31.60   178.9   100
##      hermite_100_quantiles  267.7  395.65  435.318  428.80  474.50   643.2   100
##      tdigest_100_quantiles   13.5   16.20   25.562   21.50   34.65    57.6   100
##   hermite_10_000_quantiles  504.8  709.05  768.339  758.75  832.05  1017.0   100
##   tdigest_10_000_quantiles  264.0  285.80  298.949  295.45  310.05   349.1   100
##  hermite_100_000_quantiles 2910.8 3336.10 3882.340 3371.00 3448.25 13830.8   100
##  tdigest_100_000_quantiles 2642.8 2687.60 2908.618 2703.10 2725.05 12560.4   100
</code></pre>
<p>Univariate simulation study comparing hermiter and tdigest for quantile
estimation.</p>
<pre><code class="language-r">calculate_miae_per_distro &lt;- function(full_miae = FALSE) {
  distros_index &lt;- c(1:5, 7:8, 11, 13:17, 21:28)
  numruns &lt;- total_number_of_runs
  num_obs_vec &lt;- c(1e4, 1e5, 1e6, 1e7)
  if (full_miae == TRUE) {
    p &lt;- randtoolbox::sobol(1000)
    norm_factor &lt;- 1
  } else {
    p &lt;- randtoolbox::sobol(1000) * 0.98 + 0.01
    norm_factor &lt;- 0.98
  }
  distr_name_all &lt;- c()
  num_obs_all &lt;- c()
  mae_hermite_quant &lt;- c()
  mae_t_digest_quant &lt;- c()
  count &lt;- 0
  for (num_obs in num_obs_vec) {
    for (current_distro_idx in seq_along(distros_index)) {
      dnum &lt;- distros_index[current_distro_idx]
      distr_name &lt;- benchden::berdev(dnum)$name
      r_func &lt;-
        function(core_obs) {
          benchden::rberdev(n = core_obs, dnum = dnum)
        }
      q_func &lt;-
        function(p_est) {
          benchden::qberdev(p_est, dnum = dnum)
        }
      p_func &lt;- function(x) {
        benchden::pberdev(x, dnum = dnum)
      }
      res_hermite_quant &lt;- rep(0, numruns)
      res_t_digest_quant &lt;- rep(0, numruns)
      for (run in c(1:numruns)) {
        obs &lt;- r_func(num_obs)
        h_est &lt;- hermite_estimator(observations = obs )
        td &lt;- tdigest(obs)
        q_est_hermite &lt;- h_est %&gt;% quant(p)
        q_est_t_digest &lt;- quantile(td, probs = p)
        true_quant &lt;- q_func(p)
        res_hermite_quant[run] &lt;- norm_factor *
          mean(abs(q_est_hermite - true_quant))
        res_t_digest_quant[run] &lt;- norm_factor *
          mean(abs(q_est_t_digest - true_quant))
      }
      mae_herm_quant &lt;- mean(res_hermite_quant)
      mae_t_dig_quant &lt;- mean(res_t_digest_quant)
      count &lt;- count + 1
      distr_name_all[count] &lt;- distr_name
      num_obs_all[count] &lt;- num_obs
      mae_hermite_quant[count] &lt;- mae_herm_quant
      mae_t_digest_quant[count] &lt;- mae_t_dig_quant
    }
  }
  result &lt;- data.frame(
    distribution_name = distr_name_all,
    num_obs =
      num_obs_all,
    mae_hermite_quant,
    mae_t_digest_quant
  )
  result &lt;- result %&gt;% mutate(hermite_better_quant =
                                ifelse(mae_hermite_quant &lt; mae_t_digest_quant,
                                       1, 0))
  return(result)
}
</code></pre>
<pre><code class="language-r">calculate_miae &lt;- function(miae_per_distro) {
  univariate_quantile_results &lt;- miae_per_distro %&gt;%
    group_by(num_obs) %&gt;%
    summarise(
      num_herm_better = sum(hermite_better_quant),
      total_distros = n(),
      perc_herm_better =
        sum(hermite_better_quant) / n()
    )
  return(univariate_quantile_results)
}

univar_quant_results_partial_per_distro &lt;-
  calculate_miae_per_distro(full_miae = FALSE)
univar_quant_results_full_per_distro &lt;-
  calculate_miae_per_distro(full_miae = TRUE)

univar_quant_results_partial &lt;-
  calculate_miae(univar_quant_results_partial_per_distro)
univar_quant_results_full &lt;-
  calculate_miae(univar_quant_results_full_per_distro)
</code></pre>
<p>Reproduces <strong>Table 5</strong> in the text:</p>
<pre><code class="language-r">print(univar_quant_results_full)
</code></pre>
<pre><code>## # A tibble: 4 × 4
##    num_obs num_herm_better total_distros perc_herm_better
##      &lt;dbl&gt;           &lt;dbl&gt;         &lt;int&gt;            &lt;dbl&gt;
## 1    10000              12            21            0.571
## 2   100000              16            21            0.762
## 3  1000000              18            21            0.857
## 4 10000000              18            21            0.857
</code></pre>
<p>Reproduces <strong>Table 6</strong> in the text:</p>
<pre><code class="language-r">print(univar_quant_results_partial)
</code></pre>
<pre><code>## # A tibble: 4 × 4
##    num_obs num_herm_better total_distros perc_herm_better
##      &lt;dbl&gt;           &lt;dbl&gt;         &lt;int&gt;            &lt;dbl&gt;
## 1    10000              14            21            0.667
## 2   100000              17            21            0.810
## 3  1000000              18            21            0.857
## 4 10000000              19            21            0.905
</code></pre>
<p>R implementation of count matrix algorithm of Xiao, Wei. “Novel online
algorithms for nonparametric correlations with application to analyze sensor
data.” 2019 IEEE International Conference on Big Data (Big Data). IEEE,
as an S3 class. The implementation below follows
<a href="https://github.com/wxiao0421/onlineNPCORR/">https://github.com/wxiao0421/onlineNPCORR/</a> reasonably closely in parts.</p>
<pre><code class="language-r">count_matrix_calculator &lt;-
  function(cut_points_inpt, normalize = FALSE) {
    this &lt;- list(
      cut_points = cut_points_inpt,
      count_matrix = matrix(
        rep(0, cut_points_inpt ^ 2),
        nrow = cut_points_inpt,
        ncol = cut_points_inpt,
        byrow = TRUE
      ),
      n_row = rep(0, cut_points_inpt),
      n_col = rep(0, cut_points_inpt),
      x_breaks = qnorm(p = seq(0, 1, length.out =
                                 (
                                   cut_points_inpt + 1
                                 )))[2:(cut_points_inpt)],
      y_breaks = qnorm(p = seq(0, 1, length.out =
                                 (
                                   cut_points_inpt + 1
                                 )))[2:(cut_points_inpt)],
      num_obs = 0,
      normalize_obs = normalize,
      running_mean_x = 0,
      running_mean_y = 0,
      running_variation_x = 0,
      running_variation_y = 0
    )
    class(this) &lt;- append(class(this), &quot;count_matrix_calculator&quot;)
    return(this)
  }

get_idx &lt;- function(x, breaks) {
  if (breaks[length(breaks)] &lt; x) {
    return(length(breaks) + 1)
  }
  return(which(breaks &gt;= x)[1])
}

update_matrix &lt;- function(this, x) {
  UseMethod(&quot;update_matrix&quot;, this)
}

update_matrix.count_matrix_calculator &lt;- function(this, x) {
  this$num_obs &lt;- this$num_obs + 1
  if (this$normalize_obs == TRUE) {
    prev_mean &lt;- c(this$running_mean_x, this$running_mean_y)
    upd_mean &lt;- (prev_mean * (this$num_obs - 1) + x) / this$num_obs
    this$running_mean_x  &lt;- upd_mean[1]
    this$running_mean_y  &lt;- upd_mean[2]
    if (this$num_obs &lt; 2) {
      return(this)
    }
    upd_var &lt;- c(this$running_variation_x,
                 this$running_variation_y) + (x - prev_mean) *
      (x - upd_mean)
    this$running_variation_x &lt;- upd_var[1]
    this$running_variation_y &lt;- upd_var[2]
    x &lt;- (x - upd_mean) / sqrt(upd_var / (this$num_obs))
  }
  idx_row &lt;- get_idx(x[1], this$x_breaks)
  idx_col &lt;- get_idx(x[2], this$y_breaks)
  this$count_matrix[idx_row, idx_col] &lt;-
    this$count_matrix[idx_row, idx_col] + 1
  this$n_row[idx_row] &lt;- this$n_row[idx_row] + 1
  this$n_col[idx_col] &lt;- this$n_col[idx_col] + 1
  return(this)
}

get_spearmans &lt;- function(this) {
  UseMethod(&quot;get_spearmans&quot;, this)
}

get_spearmans.count_matrix_calculator &lt;- function(this) {
  len_x_breaks &lt;- length(this$x_breaks)
  len_y_breaks &lt;- length(this$y_breaks)
  r_row &lt;- rep(0, len_x_breaks + 1)
  r &lt;- 0
  for (k in c(1:(len_x_breaks + 1))) {
    if (this$n_row[k] == 0) {
      r_row[k] &lt;- r
    } else {
      r_row[k] &lt;- ((r + 1) + (r + this$n_row[k])) / 2
      r &lt;- r + this$n_row[k]
    }
  }
  r_col &lt;- rep(0, len_y_breaks + 1)
  r &lt;- 0
  for (k in c(1:(len_y_breaks + 1))) {
    if (this$n_col[k] == 0) {
      r_col[k] &lt;- r
    } else {
      r_col[k] &lt;- ((r + 1) + (r + this$n_col[k])) / 2
      r &lt;- r + this$n_col[k]
    }
  }
  r_row &lt;- r_row - (this$num_obs + 1) / 2
  r_col &lt;- r_col - (this$num_obs + 1) / 2
  r_row &lt;- r_row / sqrt(sum(this$n_row * r_row ^ 2))
  r_col &lt;- r_col / sqrt(sum(this$n_col * r_col ^ 2))
  corr &lt;- t(r_row) %*% this$count_matrix %*% r_col
  return(corr)
}

get_kendall &lt;- function(this) {
  UseMethod(&quot;get_kendall&quot;, this)
}

get_kendall.count_matrix_calculator &lt;- function(this) {
  len_n_row &lt;- length(this$n_row)
  len_n_col &lt;- length(this$n_col)
  count_mat_sum &lt;-
    matrix(rep(0, len_n_row * len_n_col), len_n_row, len_n_col, byrow = TRUE)
  for (i in 2:len_n_row) {
    count_mat_sum[i, 2:len_n_col] &lt;-
      cumsum(this$count_matrix[(i - 1), 1:(len_n_col - 1)])
  }
  for (i in 2:len_n_row) {
    count_mat_sum[i, ] &lt;- count_mat_sum[i, ] + count_mat_sum[(i - 1), ]
  }
  concord_pairs &lt;- sum(this$count_matrix * count_mat_sum)
  ties_in_x &lt;- 0
  for (i in 1:len_n_row) {
    ties_in_x &lt;- ties_in_x + (this$n_row[i] ^ 2 -
                                sum(this$count_matrix[i, ] ^ 2)) / 2
  }
  ties_in_y &lt;- 0
  for (j in 1:len_n_col) {
    ties_in_y &lt;- ties_in_y + (this$n_col[j] ^ 2 -
                                sum(this$count_matrix[, j] ^ 2)) / 2
  }
  ties_in_x_and_y &lt;- sum(this$count_matrix * (this$count_matrix - 1)) / 2
  discord_pairs &lt;- this$num_obs * (this$num_obs - 1) / 2 - concord_pairs -
    ties_in_x - ties_in_y - ties_in_x_and_y
  corr &lt;- (concord_pairs - discord_pairs) /
    sqrt((concord_pairs + discord_pairs + ties_in_x) *
           (concord_pairs + discord_pairs + ties_in_y))
  return(corr)
}
</code></pre>
<p>Bivariate simulation study comparing hermiter and count matrix
algorithms for estimation of Spearman’s Rho and Kendall Tau coefficients.</p>
<pre><code class="language-r">rho_inpt &lt;- c(-0.75, -0.5, -0.25, 0.25, 0.5, 0.75)
num_obs_inpt &lt;- c(1e4, 5e4, 1e5)
runs &lt;- total_number_of_runs
mae_matrix_kendall &lt;- c()
mae_hermite_kendall &lt;- c()
mae_matrix_spear &lt;- c()
mae_hermite_spear &lt;- c()
rho_vec &lt;- c()
num_obs_vec &lt;- c()
sig_x &lt;- 1
sig_y &lt;- 1
for (num_obs in num_obs_inpt) {
  for (rho in rho_inpt) {
    for (j in 1:runs) {
      obs_mat &lt;- mvtnorm::rmvnorm(
        n = num_obs,
        mean = rep(0, 2),
        sigma = matrix(
          c(sig_x ^ 2, rho * sig_x * sig_y,
            rho * sig_x * sig_y, sig_y ^ 2),
          nrow = 2,
          ncol = 2,
          byrow = T
        )
      )
      matrix_est_c30 &lt;-
        count_matrix_calculator(cut_points_inpt = 30,
                                normalize = F)
      matrix_est_c100 &lt;-
        count_matrix_calculator(cut_points_inpt = 100,
                                normalize = F)
      hermite_est &lt;-
        hermite_estimator(est_type = &quot;bivariate&quot;, standardize = F)
      for (i in seq_len(nrow(obs_mat))) {
        matrix_est_c100 &lt;- matrix_est_c100 %&gt;% update_matrix(obs_mat[i, ])
        matrix_est_c30 &lt;-
          matrix_est_c30 %&gt;% update_matrix(obs_mat[i, ])
        hermite_est &lt;-
          hermite_est %&gt;% update_sequential(obs_mat[i, ])
      }
      kendall_est_matrix &lt;-
        matrix_est_c100 %&gt;% get_kendall()
      kendall_est_hermite &lt;- hermite_est %&gt;% kendall()
      spear_est_matrix &lt;-
        matrix_est_c30 %&gt;% get_spearmans()
      spear_est_hermite &lt;- hermite_est %&gt;% spearmans()
      kendall_true &lt;- 2 / pi * asin(rho)
      spear_true &lt;- cor(obs_mat, method = &quot;spearman&quot;)[1, 2]
      mae_matrix_kendall &lt;- append(mae_matrix_kendall,
                                   abs(kendall_est_matrix - kendall_true))
      mae_hermite_kendall &lt;- append(mae_hermite_kendall,
                                    abs(kendall_est_hermite - kendall_true))
      mae_matrix_spear &lt;- append(mae_matrix_spear,
                                 abs(spear_est_matrix - spear_true))
      mae_hermite_spear &lt;- append(mae_hermite_spear,
                                  abs(spear_est_hermite - spear_true))
      num_obs_vec &lt;- append(num_obs_vec, num_obs)
      rho_vec &lt;- append(rho_vec, rho)
    }
  }
}
result &lt;-
  data.frame(
    num_obs_vec,
    rho_vec,
    mae_matrix_kendall,
    mae_hermite_kendall,
    mae_matrix_spear,
    mae_hermite_spear
  )
summary_by_rho_and_num_obs &lt;-
  result %&gt;%
  group_by(num_obs_vec, rho_vec) %&gt;%
  summarise(
    mae_matrix_kendall = mean(mae_matrix_kendall),
    mae_hermite_kendall =
      mean(mae_hermite_kendall),
    mae_matrix_spear = mean(mae_matrix_spear),
    mae_hermite_spear = mean(mae_hermite_spear)
  )
summary_num_obs_kendall &lt;- summary_by_rho_and_num_obs %&gt;%
  group_by(num_obs_vec) %&gt;%
  summarise(
    mae_matrix_kendall_avg =
      mean(mae_matrix_kendall) * 100,
    mae_hermite_kendall_avg =
      mean(mae_hermite_kendall) * 100,
    sd_matrix_kendall =
      sd(mae_matrix_kendall) * 100,
    sd_hermite_kendall = sd(mae_hermite_kendall) * 100
  )
summary_num_obs_spear  &lt;- summary_by_rho_and_num_obs %&gt;%
  group_by(num_obs_vec) %&gt;%
  summarise(
    mae_matrix_spear_avg =
      mean(mae_matrix_spear) * 100,
    mae_hermite_spear_avg = mean(mae_hermite_spear) * 100,
    sd_matrix_spear = sd(mae_matrix_spear) * 100,
    sd_hermite_spear =
      sd(mae_hermite_spear) * 100
  )
</code></pre>
<p>Reproduces <strong>Table 7</strong> in the text.</p>
<pre><code class="language-r">print(summary_num_obs_spear)
</code></pre>
<pre><code>## # A tibble: 3 × 5
##   num_obs_vec mae_matrix_spear_avg mae_hermite_spear_avg sd_matrix_spear sd_hermite_spear
##         &lt;dbl&gt;                &lt;dbl&gt;                 &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;
## 1       10000               0.103                 0.144           0.0293          0.0119 
## 2       50000               0.0992                0.0645          0.0282          0.00306
## 3      100000               0.0995                0.0438          0.0288          0.00362
</code></pre>
<p>Reproduces <strong>Table 8</strong> in the text.</p>
<pre><code class="language-r">print(summary_num_obs_kendall)
</code></pre>
<pre><code>## # A tibble: 3 × 5
##   num_obs_vec mae_matrix_kendall_avg mae_hermite_kendall_avg sd_matrix_kendall sd_hermite_kendall
##         &lt;dbl&gt;                  &lt;dbl&gt;                   &lt;dbl&gt;             &lt;dbl&gt;              &lt;dbl&gt;
## 1       10000                  0.577                   0.505            0.0264             0.0981
## 2       50000                  0.390                   0.216            0.125              0.0388
## 3      100000                  0.353                   0.156            0.135              0.0282
</code></pre>
<p>Computational Details</p>
<pre><code class="language-r">sessionInfo()
</code></pre>
<pre><code>## R version 4.2.2 (2022-10-31 ucrt)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19045)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_South Africa.utf8  LC_CTYPE=English_South Africa.utf8   
## [3] LC_MONETARY=English_South Africa.utf8 LC_NUMERIC=C                         
## [5] LC_TIME=English_South Africa.utf8    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] arrow_10.0.0         patchwork_1.1.2      ggplot2_3.4.0        randtoolbox_2.0.3    rngWELL_0.10-8      
## [6] dplyr_1.0.10         microbenchmark_1.4.9 tdigest_0.4.1        hermiter_2.2.0      
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_1.2.0   xfun_0.34          purrr_0.3.5        colorspace_2.0-3   vctrs_0.5.0       
##  [6] generics_0.1.3     htmltools_0.5.3    yaml_2.3.6         utf8_1.2.2         rlang_1.0.6       
## [11] pillar_1.8.1       withr_2.5.0        glue_1.6.2         DBI_1.1.3          bit64_4.0.5       
## [16] foreach_1.5.2      lifecycle_1.0.3    stringr_1.4.1      anytime_0.3.9      munsell_0.5.0     
## [21] gtable_0.3.1       mvtnorm_1.1-3      codetools_0.2-18   evaluate_0.18      labeling_0.4.2    
## [26] knitr_1.40         tzdb_0.3.0         fastmap_1.1.0      parallel_4.2.2     fansi_1.0.3       
## [31] highr_0.9          Rcpp_1.0.9         readr_2.1.3        scales_1.2.1       benchden_1.0.5    
## [36] RcppParallel_5.1.5 farver_2.1.1       bit_4.0.4          hms_1.1.2          digest_0.6.30     
## [41] stringi_1.7.8      grid_4.2.2         fasttime_1.1-0     cli_3.4.1          tools_4.2.2       
## [46] magrittr_2.0.3     tibble_3.1.8       pkgconfig_2.0.3    ellipsis_0.3.2     timechange_0.1.1  
## [51] lubridate_1.9.0    assertthat_0.2.1   rmarkdown_2.18     rstudioapi_0.14    iterators_1.0.14  
## [56] R6_2.5.1           compiler_4.2.2
</code></pre>

</body>

</html>
